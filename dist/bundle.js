(()=>{"use strict";function e(e){return void 0===e&&(e="canvas"),document.getElementById(e)}function t(e){return e[Math.floor(Math.random()*e.length)]}function n(e,t,n){t.fillStyle="rgb("+n.r+", "+n.g+", "+n.b+")",t.fillRect(e.x,e.y,e.widthPixel,e.heightPixel)}function o(e,n){for(var o=[],i=0;i<Math.floor(e/2);i++)o.push(t(n));return o.slice(0).reverse().forEach((function(e){return o.push(e)})),e%2!=0&&o.splice(Math.floor(e/2),0,t(n)),o}function i(e,t,i,r,a){var l=e.x,c=e.y,d=e.widthPixel,h=e.heightPixel;console.log(e);for(var u=0;u<r;u+=1)for(var g=o(i,a),f=0;f<g.length;f+=1)n({x:l+f*d,y:c+u*h,widthPixel:d,heightPixel:h},t,g[f])}function r(){var t=e();if(t.getContext){var n=g||8,o=f||8,r=t.getContext("2d");if(r.clearRect(0,0,t.width,t.height),1===v){var a=Math.floor(t.width/n),l=t.width%n,c=Math.floor(t.height/o);i({x:l/2,y:(u=t.height%o)/2,widthPixel:a,heightPixel:a},r,n,o,m)}else{a=t.width/v,c=t.height/v;for(var d=Math.floor(a/n),h=(l=a%n,Math.floor(c/o)),u=c%o,s=0;s<v;s+=1)for(var x=0;x<v;x+=1)i({x:l/2+s*a,y:u/2+x*c,widthPixel:d,heightPixel:h},r,n,o,m)}}}function a(t,n){var o,i,r,a=n.target.value;"width"===t?(u=a,document.getElementById("widthCanvasValue").textContent=a.toString()):document.getElementById("heightCanvasValue").textContent=a.toString(),o=u,i=a,(r=e()).width=o,r.height=i}function l(e,t){var n=t.target.value;"x"===e?(g=n,document.getElementById("nbPixelXValue").textContent=n.toString()):(f=n,document.getElementById("nbPixelYValue").textContent=n.toString())}function c(){var e=[];Array.from(document.querySelectorAll("input[type=color]")).forEach((function(t,n){var o,i;document.getElementById("color-"+(n+1)).checked&&e.push((o=t.value,(i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(o))?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null))})),m=e.slice()}function d(e){var t=e.target.value;document.getElementById("repetitionValue").textContent=t.toString(),v=t}function h(){var t=e();if(t){var n=t.toDataURL("image/png").replace("image/png","image/octet-stream");window.location.href=n}else alert("canvas not detected")}var u=0,g=0,f=0,v=1,m=[];window.onload=function(){c(),r();var e=document.getElementById("reset-button");e&&e.addEventListener("click",r);var t=document.getElementById("save-button");t&&t.addEventListener("click",h);var n=document.getElementById("widthCanvas");n&&n.addEventListener("change",(function(e){a("width",e),r()}));var o=document.getElementById("heightCanvas");o&&o.addEventListener("change",(function(e){a("height",e),r()}));var i=document.getElementById("nbPixelX");i&&i.addEventListener("change",(function(e){l("x",e),r()}));var u=document.getElementById("nbPixelY");u&&u.addEventListener("change",(function(e){l("y",e),r()}));var g=document.getElementById("repetition");g&&g.addEventListener("change",(function(e){d(e),r()})),Array.from(document.querySelectorAll("input[type=color]")).forEach((function(e){e.addEventListener("change",c)})),Array.from(document.querySelectorAll("input[type=checkbox]")).forEach((function(e){e.addEventListener("change",c)}))}})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hdmF0YXItZ2VuZXJhdG9yLy4vc3JjL2NhbnZhcy50cyIsIndlYnBhY2s6Ly9hdmF0YXItZ2VuZXJhdG9yLy4vc3JjL2F2YXRhci50cyIsIndlYnBhY2s6Ly9hdmF0YXItZ2VuZXJhdG9yLy4vc3JjL2luZGV4LnRzIiwid2VicGFjazovL2F2YXRhci1nZW5lcmF0b3IvLi9zcmMvdG9vbHMudHMiXSwibmFtZXMiOlsiZ2V0Q2FudmFzIiwiY2FudmFzSWQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwicmFuZG9tSW5BcnJheUNvbG9yIiwiY29sb3JzIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwibGVuZ3RoIiwiY3JlYXRlU3F1YXJlIiwiYm9yZGVyIiwiY29udGV4dCIsImNvbG9yIiwiZmlsbFN0eWxlIiwiciIsImciLCJiIiwiZmlsbFJlY3QiLCJ4IiwieSIsIndpZHRoUGl4ZWwiLCJoZWlnaHRQaXhlbCIsImdlbmVyYXRlUm93Q29sb3JzIiwibmJQaXhlbFdpZHRoIiwiY29sb3JzUGFsZXR0ZSIsImJpdHNDb2xvciIsImkiLCJwdXNoIiwic2xpY2UiLCJyZXZlcnNlIiwiZm9yRWFjaCIsImJpdCIsInNwbGljZSIsImNyZWF0ZUludmFkZXIiLCJuYlBpeGVsSGVpZ2h0IiwieE9mZnNldCIsInlPZmZzZXQiLCJjb25zb2xlIiwibG9nIiwibG9hZCIsImNhbnZhcyIsImdldENvbnRleHQiLCJuYlBpeGVsWCIsIm5iUGl4ZWxZIiwiY2xlYXJSZWN0Iiwid2lkdGgiLCJoZWlnaHQiLCJyZXBldGl0aW9uIiwiYXZhdGFyV2lkdGgiLCJvZmZzZXRXaWR0aCIsImF2YXRhckhlaWdodCIsIm9mZnNldEhlaWdodCIsIl94IiwiX3kiLCJjaGFuZ2VDYW52YXNTbGlkZXIiLCJzaXplIiwiZSIsIm5ld1ZhbHVlIiwidGFyZ2V0IiwidmFsdWUiLCJ3aWR0aENhbnZhcyIsInRleHRDb250ZW50IiwidG9TdHJpbmciLCJjaGFuZ2VQaXhlbFNsaWRlciIsImZlZWRDb2xvcnMiLCJuZXdDb2xvcnMiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiaXRlbSIsImluZGV4IiwiaGV4IiwicmVzdWx0IiwiY2hlY2tlZCIsImV4ZWMiLCJwYXJzZUludCIsImNoYW5nZVJlcGV0aXRpb24iLCJzYXZlSW1hZ2UiLCJpbWFnZSIsInRvRGF0YVVSTCIsInJlcGxhY2UiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJhbGVydCIsIm9ubG9hZCIsImJ1dHRvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJzYXZlQnV0dG9uIiwiaW5wdXRXaWR0aCIsImlucHV0SGVpZ2h0IiwiaW5wdXRQaXhlbFgiLCJpbnB1dFBpeGVsWSJdLCJtYXBwaW5ncyI6Im1CQUNPLFNBQVNBLEVBQVVDLEdBQ3hCLFlBRHdCLElBQUFBLE1BQUEsVUFDakJDLFNBQVNDLGVBQWVGLEdDa0JqQyxTQUFTRyxFQUFtQkMsR0FDMUIsT0FBT0EsRUFBT0MsS0FBS0MsTUFBTUQsS0FBS0UsU0FBV0gsRUFBT0ksU0FJbEQsU0FBU0MsRUFBYUMsRUFBeUJDLEVBQW1DQyxHQUNoRkQsRUFBUUUsVUFBWSxPQUFPRCxFQUFNRSxFQUFDLEtBQUtGLEVBQU1HLEVBQUMsS0FBS0gsRUFBTUksRUFBQyxJQUMxREwsRUFBUU0sU0FBU1AsRUFBT1EsRUFBR1IsRUFBT1MsRUFBR1QsRUFBT1UsV0FBWVYsRUFBT1csYUFJakUsU0FBU0MsRUFBa0JDLEVBQXNCQyxHQUUvQyxJQURBLElBQUlDLEVBQStCLEdBQzNCQyxFQUFJLEVBQUdBLEVBQUlyQixLQUFLQyxNQUFNaUIsRUFBYSxHQUFJRyxJQUM3Q0QsRUFBVUUsS0FBS3hCLEVBQW1CcUIsSUFVcEMsT0FQQUMsRUFBVUcsTUFBTSxHQUFHQyxVQUFVQyxTQUFRLFNBQUNDLEdBQVEsT0FBQU4sRUFBVUUsS0FBS0ksTUFHMURSLEVBQWUsR0FBTSxHQUN0QkUsRUFBVU8sT0FBTzNCLEtBQUtDLE1BQU1pQixFQUFhLEdBQUksRUFBR3BCLEVBQW1CcUIsSUFHOURD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LElBQUtQLEdBQUlqQixPQUU3RSxJQUFNcUQsRUFBYzNGLFNBQVNDLGVBQWUsWUFDekMwRixHQUNEQSxFQUFZTCxpQkFBaUIsVUFBVSxTQUFDL0IsR0FBUU8sRUFBa0IsSUFBS1AsR0FBSWpCLE9BRzdFLElBQU1RLEVBQWE5QyxTQUFTQyxlQUFlLGNBQ3hDNkMsR0FDREEsRUFBV3dDLGlCQUFpQixVQUFVLFNBQUMvQixHQUFRb0IsRUFBaUJwQixHQUFJakIsT0FJdEUyQixNQUFNQyxLQUFLbEUsU0FBU21FLGlCQUFpQixzQkFBc0J0QyxTQUFTLFNBQUN1QyxHQUNuRUEsRUFBS2tCLGlCQUFpQixTQUFVdkIsTUFHbENFLE1BQU1DLEtBQUtsRSxTQUFTbUUsaUJBQWlCLHlCQUF5QnRDLFNBQVMsU0FBQ3VDLEdBQ3RFQSxFQUFLa0IsaUJBQWlCLFNBQVV2QixRIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuZXhwb3J0IGZ1bmN0aW9uIGdldENhbnZhcyhjYW52YXNJZDogc3RyaW5nID0gJ2NhbnZhcycpIDogSFRNTENhbnZhc0VsZW1lbnQgfCBudWxsIHtcbiAgcmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNhbnZhc0lkKSBhcyBIVE1MQ2FudmFzRWxlbWVudDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNldENhbnZhc1NpemUod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpIDogdm9pZCAge1xuICBjb25zdCBjYW52YXMgPSBnZXRDYW52YXMoKTtcbiAgY2FudmFzLndpZHRoID0gd2lkdGg7XG4gIGNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkcmF3KGNhbGxiYWNrOiAoY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQpID0+IHZvaWQpIDogdm9pZCB7XG4gIGNvbnN0IGNhbnZhcyA9IGdldENhbnZhcygpO1xuICBpZiAoY2FudmFzLmdldENvbnRleHQpIHtcbiAgICBjb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICBjYWxsYmFjayhjdHgpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjaGFuZ2VCYWNrZ3JvdW5kQ2FudmFzKHJhbmRvbSA6IGJvb2xlYW4gPSBmYWxzZSkgOiB2b2lkIHtcbiAgY29uc3QgY2FudmFzID0gZ2V0Q2FudmFzKCk7XG4gIGlmKGNhbnZhcy5nZXRDb250ZXh0KSB7XG4gICAgY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG4gICAgY29uc3QgY29sb3IgPSByYW5kb20gPyBcbiAgICAgIGByZ2JhKFxuICAgICAgICAgJHtNYXRoLnJhbmRvbSgpICogMjU1fSxcbiAgICAgICAgICR7TWF0aC5yYW5kb20oKSAqIDI1NX0sXG4gICAgICAgICAke01hdGgucmFuZG9tKCkgKiAyNTV9LFxuICAgICAgICAgMSlgOlxuICAgICAgJ3JnYmEoMjEyLDI1NSwxNTYsMSknO1xuICAgIGN0eC5maWxsU3R5bGUgPSBjb2xvcjtcbiAgICBjdHguZmlsbFJlY3QoMCwwLHdpbmRvdy5pbm5lcldpZHRoLHdpbmRvdy5pbm5lckhlaWdodCk7XG4gIH1cbn0iLCJpbnRlcmZhY2UgYm9yZGVySW50ZXJmYWNlIHtcbiAgeDogbnVtYmVyO1xuICB5OiBudW1iZXI7XG4gIHdpZHRoUGl4ZWw6IG51bWJlcjtcbiAgaGVpZ2h0UGl4ZWw6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBjb2xvckludGVyZmFjZSB7XG4gIHI6IG51bWJlcjtcbiAgZzogbnVtYmVyO1xuICBiOiBudW1iZXI7XG59XG5cblxuY29uc3QgQkxBQ0sgOiBjb2xvckludGVyZmFjZSA9IHsgcjogMCwgZzowLCBiOjAgfTtcblxuZnVuY3Rpb24gcmFuZG9tQ29sb3IoKSA6IGNvbG9ySW50ZXJmYWNlIHtcbiAgcmV0dXJuIHsgcjogTWF0aC5yYW5kb20oKSAqIDI1NSwgZzogTWF0aC5yYW5kb20oKSAqIDI1NSwgYjogTWF0aC5yYW5kb20oKSAqIDI1NSB9O1xufVxuXG5mdW5jdGlvbiByYW5kb21JbkFycmF5Q29sb3IoY29sb3JzOiBjb2xvckludGVyZmFjZVtdKSA6IGNvbG9ySW50ZXJmYWNlIHtcbiAgcmV0dXJuIGNvbG9yc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjb2xvcnMubGVuZ3RoKV07XG59IFxuXG5cbmZ1bmN0aW9uIGNyZWF0ZVNxdWFyZShib3JkZXI6IGJvcmRlckludGVyZmFjZSwgY29udGV4dDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELCBjb2xvcjogY29sb3JJbnRlcmZhY2UpIDogdm9pZCB7XG4gIGNvbnRleHQuZmlsbFN0eWxlID0gYHJnYigke2NvbG9yLnJ9LCAke2NvbG9yLmd9LCAke2NvbG9yLmJ9KWA7XG4gIGNvbnRleHQuZmlsbFJlY3QoYm9yZGVyLngsIGJvcmRlci55LCBib3JkZXIud2lkdGhQaXhlbCwgYm9yZGVyLmhlaWdodFBpeGVsKTtcbn1cblxuXG5mdW5jdGlvbiBnZW5lcmF0ZVJvd0NvbG9ycyhuYlBpeGVsV2lkdGg6IG51bWJlciwgY29sb3JzUGFsZXR0ZTogY29sb3JJbnRlcmZhY2VbXSkgOiBjb2xvckludGVyZmFjZVtdIHtcbiAgbGV0IGJpdHNDb2xvciA6IGNvbG9ySW50ZXJmYWNlW10gPSBbXTtcbiAgZm9yKGxldCBpID0gMDsgaSA8IE1hdGguZmxvb3IobmJQaXhlbFdpZHRoLzIpOyBpKyspIHtcbiAgICBiaXRzQ29sb3IucHVzaChyYW5kb21JbkFycmF5Q29sb3IoY29sb3JzUGFsZXR0ZSkpO1xuICB9XG5cbiAgYml0c0NvbG9yLnNsaWNlKDApLnJldmVyc2UoKS5mb3JFYWNoKChiaXQpID0+IGJpdHNDb2xvci5wdXNoKGJpdCkpO1xuXG4gIC8vIGFkZCBvbmUgbW9yZSBiaXRzIGZvciBvZGRzIHdpZHRoXG4gIGlmKG5iUGl4ZWxXaWR0aCAlIDIgIT09IDApIHtcbiAgICBiaXRzQ29sb3Iuc3BsaWNlKE1hdGguZmxvb3IobmJQaXhlbFdpZHRoLzIpLCAwLCByYW5kb21JbkFycmF5Q29sb3IoY29sb3JzUGFsZXR0ZSkpO1xuICB9XG5cbiAgcmV0dXJuIGJpdHNDb2xvcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUludmFkZXIoYm9yZGVyIDogYm9yZGVySW50ZXJmYWNlLCBjb250ZXh0OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQsIG5iUGl4ZWxXaWR0aDogbnVtYmVyLCBuYlBpeGVsSGVpZ2h0OiBudW1iZXIsIGNvbG9yc1BhbGV0dGU6IGNvbG9ySW50ZXJmYWNlW10pIDogdm9pZCB7XG4gIGNvbnN0IHsgeDogeE9mZnNldCAsIHk6IHlPZmZzZXQgLCB3aWR0aFBpeGVsLCBoZWlnaHRQaXhlbCB9ID0gYm9yZGVyO1xuICBjb25zb2xlLmxvZyhib3JkZXIpXG4gIGZvcihsZXQgeSA6IG51bWJlciA9IDA7IHkgPCBuYlBpeGVsSGVpZ2h0OyB5ICs9IDEpIHtcbiAgICBjb25zdCBiaXRzQ29sb3IgPSBnZW5lcmF0ZVJvd0NvbG9ycyhuYlBpeGVsV2lkdGgsIGNvbG9yc1BhbGV0dGUpO1xuICAgIGZvcihsZXQgeDogbnVtYmVyID0gMDsgeCA8IGJpdHNDb2xvci5sZW5ndGg7IHggKz0gMSkge1xuICAgICAgY3JlYXRlU3F1YXJlKFxuICAgICAgICB7IHg6IHhPZmZzZXQgKyAoeCAqIHdpZHRoUGl4ZWwpLFxuICAgICAgICAgIHk6IHlPZmZzZXQgKyAoeSAqIGhlaWdodFBpeGVsKSxcbiAgICAgICAgICB3aWR0aFBpeGVsLFxuICAgICAgICAgIGhlaWdodFBpeGVsXG4gICAgICAgICB9LFxuICAgICAgICAgY29udGV4dCxcbiAgICAgICAgIGJpdHNDb2xvclt4XVxuICAgICAgKTtcbiAgICB9XG4gIH1cbn0iLCJpbXBvcnQgeyBzZXRDYW52YXNTaXplLCBjaGFuZ2VCYWNrZ3JvdW5kQ2FudmFzLCBnZXRDYW52YXMsIGRyYXcgfSBmcm9tIFwiLi9jYW52YXNcIjtcbmltcG9ydCB7IGNyZWF0ZUludmFkZXIsIGNvbG9ySW50ZXJmYWNlIH0gZnJvbSBcIi4vYXZhdGFyXCI7XG5pbXBvcnQgeyBoZXhUb1JnYiB9IGZyb20gXCIuL3Rvb2xzXCI7XG5cbmZ1bmN0aW9uIGxvYWQoKSB7XG4gY29uc3QgY2FudmFzID0gZ2V0Q2FudmFzKCk7XG4gIGlmIChjYW52YXMuZ2V0Q29udGV4dCkge1xuICAgIGNvbnN0IG5iUGl4ZWxXaWR0aCA9IG5iUGl4ZWxYIHx8IDg7XG4gICAgY29uc3QgbmJQaXhlbEhlaWdodCA9IG5iUGl4ZWxZIHx8IDg7XG4gICAgY29uc3QgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgIC8vIHJlZnJlc2hcbiAgICBjb250ZXh0LmNsZWFyUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xuXG5cbiAgICAvLyBvbmx5IG9uZSBhdmF0YXJcbiAgICBpZihyZXBldGl0aW9uID09PSAxKSB7XG4gICAgICBcbiAgICAgIGNvbnN0IGF2YXRhcldpZHRoID0gTWF0aC5mbG9vcihjYW52YXMud2lkdGggLyBuYlBpeGVsV2lkdGgpO1xuICAgICAgY29uc3Qgb2Zmc2V0V2lkdGggPSAoY2FudmFzLndpZHRoICUgbmJQaXhlbFdpZHRoKTtcbiAgICAgIFxuICAgICAgY29uc3QgYXZhdGFySGVpZ2h0ID0gTWF0aC5mbG9vcihjYW52YXMuaGVpZ2h0IC8gbmJQaXhlbEhlaWdodCk7XG4gICAgICBjb25zdCBvZmZzZXRIZWlnaHQgPSAoY2FudmFzLmhlaWdodCAlIG5iUGl4ZWxIZWlnaHQpO1xuXG4gICAgICBjcmVhdGVJbnZhZGVyKFxuICAgICAgICB7eDogb2Zmc2V0V2lkdGggLzIgLCB5OiBvZmZzZXRIZWlnaHQgLyAyLCB3aWR0aFBpeGVsOiBhdmF0YXJXaWR0aCwgaGVpZ2h0UGl4ZWw6IGF2YXRhcldpZHRoIH0sXG4gICAgICAgIGNvbnRleHQsXG4gICAgICAgIG5iUGl4ZWxXaWR0aCxcbiAgICAgICAgbmJQaXhlbEhlaWdodCxcbiAgICAgICAgY29sb3JzXG4gICAgICApO1xuICAgIH0gZWxzZSB7IC8vIHBhdGNod29ya1xuICAgICAgY29uc3QgYXZhdGFyV2lkdGggPSBjYW52YXMud2lkdGggLyByZXBldGl0aW9uO1xuICAgICAgY29uc3QgYXZhdGFySGVpZ2h0ID0gY2FudmFzLmhlaWdodCAvIHJlcGV0aXRpb247XG4gICAgICBcbiAgICAgIGNvbnN0IHdpZHRoUGl4ZWwgPSBNYXRoLmZsb29yKGF2YXRhcldpZHRoIC8gbmJQaXhlbFdpZHRoKTtcbiAgICAgIGNvbnN0IG9mZnNldFdpZHRoID0gYXZhdGFyV2lkdGggJSBuYlBpeGVsV2lkdGg7XG5cbiAgICAgIGNvbnN0IGhlaWdodFBpeGVsID0gTWF0aC5mbG9vcihhdmF0YXJIZWlnaHQgLyBuYlBpeGVsSGVpZ2h0KTtcbiAgICAgIGNvbnN0IG9mZnNldEhlaWdodCA9IChhdmF0YXJIZWlnaHQgJSBuYlBpeGVsSGVpZ2h0KTtcblxuICAgICAgZm9yKGxldCBfeCA9IDA7IF94IDwgcmVwZXRpdGlvbjsgX3ggKz0gMSkge1xuICAgICAgICBmb3IobGV0IF95ID0gMDsgX3kgPCByZXBldGl0aW9uOyBfeSArPSAxKSB7XG4gICAgICAgICAgY3JlYXRlSW52YWRlcihcbiAgICAgICAgICAgIHt4OiAob2Zmc2V0V2lkdGggLyAyKSArX3ggKiBhdmF0YXJXaWR0aCAsIHk6IChvZmZzZXRIZWlnaHQgLyAyKSArIF95ICogYXZhdGFySGVpZ2h0LCB3aWR0aFBpeGVsLCBoZWlnaHRQaXhlbCB9LFxuICAgICAgICAgICAgY29udGV4dCxcbiAgICAgICAgICAgIG5iUGl4ZWxXaWR0aCxcbiAgICAgICAgICAgIG5iUGl4ZWxIZWlnaHQsXG4gICAgICAgICAgICBjb2xvcnNcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGNoYW5nZUNhbnZhc1NsaWRlcihzaXplOiBcIndpZHRoXCJ8IFwiaGVpZ2h0XCIsIGU6IEV2ZW50KSA6IHZvaWQge1xuICBjb25zdCBuZXdWYWx1ZSA6IG51bWJlciA9IChlIGFzIGFueSkudGFyZ2V0LnZhbHVlO1xuICBpZihzaXplID09PSBcIndpZHRoXCIpIHtcbiAgICB3aWR0aENhbnZhcyA9IG5ld1ZhbHVlO1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwid2lkdGhDYW52YXNWYWx1ZVwiKS50ZXh0Q29udGVudCA9IG5ld1ZhbHVlLnRvU3RyaW5nKCk7XG4gIH0gZWxzZSB7XG4gICAgaGVpZ2h0Q2FudmFzID0gbmV3VmFsdWU7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJoZWlnaHRDYW52YXNWYWx1ZVwiKS50ZXh0Q29udGVudCA9IG5ld1ZhbHVlLnRvU3RyaW5nKCk7XG4gIH1cbiAgc2V0Q2FudmFzU2l6ZSh3aWR0aENhbnZhcywgbmV3VmFsdWUpO1xufVxuXG5mdW5jdGlvbiBjaGFuZ2VQaXhlbFNsaWRlcihzaXplOiBcInhcInwgXCJ5XCIsIGU6IEV2ZW50KSA6IHZvaWQge1xuICBjb25zdCBuZXdWYWx1ZSA6IG51bWJlciA9IChlIGFzIGFueSkudGFyZ2V0LnZhbHVlO1xuICBpZihzaXplID09PSBcInhcIikge1xuICAgIG5iUGl4ZWxYID0gbmV3VmFsdWU7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuYlBpeGVsWFZhbHVlXCIpLnRleHRDb250ZW50ID0gbmV3VmFsdWUudG9TdHJpbmcoKTtcbiAgfSBlbHNlIHtcbiAgICBuYlBpeGVsWSA9IG5ld1ZhbHVlO1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibmJQaXhlbFlWYWx1ZVwiKS50ZXh0Q29udGVudCA9IG5ld1ZhbHVlLnRvU3RyaW5nKCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gZmVlZENvbG9ycygpIHtcbiAgY29uc3QgbmV3Q29sb3JzIDogY29sb3JJbnRlcmZhY2VbXSA9IFtdO1xuICBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbnB1dFt0eXBlPWNvbG9yXVwiKSkuZm9yRWFjaCgoaXRlbTogSFRNTElucHV0RWxlbWVudCwgaW5kZXg6IG51bWJlcikgPT4ge1xuICAgIGNvbnN0IGNoZWNrYm94ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYGNvbG9yLSR7aW5kZXgrMX1gKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgIGlmKGNoZWNrYm94LmNoZWNrZWQpIHtcbiAgICAgIG5ld0NvbG9ycy5wdXNoKGhleFRvUmdiKGl0ZW0udmFsdWUpKTtcbiAgICB9XG4gIH0pO1xuICBjb2xvcnMgPSBuZXdDb2xvcnMuc2xpY2UoKTtcbn1cblxuZnVuY3Rpb24gY2hhbmdlUmVwZXRpdGlvbihlOiBFdmVudCkge1xuICBjb25zdCBuZXdWYWx1ZSA9IChlIGFzIGFueSkudGFyZ2V0LnZhbHVlO1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJlcGV0aXRpb25WYWx1ZVwiKS50ZXh0Q29udGVudCA9IG5ld1ZhbHVlLnRvU3RyaW5nKCk7XG4gIHJlcGV0aXRpb24gPSBuZXdWYWx1ZVxufVxuXG5mdW5jdGlvbiBzYXZlSW1hZ2UoKSB7XG4gIGNvbnN0IGNhbnZhcyA9IGdldENhbnZhcygpO1xuICBpZihjYW52YXMpIHtcbiAgICBjb25zdCBpbWFnZSA9IGNhbnZhcy50b0RhdGFVUkwoXCJpbWFnZS9wbmdcIikucmVwbGFjZShcImltYWdlL3BuZ1wiLCBcImltYWdlL29jdGV0LXN0cmVhbVwiKTtcbiAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGltYWdlO1xuICB9IGVsc2Uge1xuICAgIGFsZXJ0KFwiY2FudmFzIG5vdCBkZXRlY3RlZFwiKTtcbiAgfVxufVxuXG4vLyBHTE9CQUxTIFZBUklBQkxFU1xubGV0IHdpZHRoQ2FudmFzID0gMDtcbmxldCBoZWlnaHRDYW52YXMgPSAwO1xubGV0IG5iUGl4ZWxYID0gMDtcbmxldCBuYlBpeGVsWSA9IDA7XG5sZXQgcmVwZXRpdGlvbiA9IDE7XG5sZXQgY29sb3JzIDpjb2xvckludGVyZmFjZVtdID0gW107XG53aW5kb3cub25sb2FkID0gZnVuY3Rpb24oKSB7XG4gIGZlZWRDb2xvcnMoKTtcbiAgbG9hZCgpO1xuICBcbiAgLy8gY29ubmVjdCBidXR0b24gKyBpbnB1dHNcbiAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZXNldC1idXR0b25cIik7XG4gICBpZihidXR0b24pIHtcbiAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBsb2FkKTtcbiAgfVxuXG4gIGNvbnN0IHNhdmVCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNhdmUtYnV0dG9uXCIpO1xuICAgaWYoc2F2ZUJ1dHRvbikge1xuICAgICBzYXZlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBzYXZlSW1hZ2UpO1xuICB9XG5cbiAgY29uc3QgaW5wdXRXaWR0aCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwid2lkdGhDYW52YXNcIik7XG4gIGlmKGlucHV0V2lkdGgpIHtcbiAgICBpbnB1dFdpZHRoLmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgKGUpID0+IHsgY2hhbmdlQ2FudmFzU2xpZGVyKFwid2lkdGhcIiwgZSk7IGxvYWQoKSB9KTtcbiAgfVxuICBjb25zdCBpbnB1dEhlaWdodCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaGVpZ2h0Q2FudmFzXCIpO1xuICBpZihpbnB1dEhlaWdodCkge1xuICAgIGlucHV0SGVpZ2h0LmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgKGUpID0+IHsgY2hhbmdlQ2FudmFzU2xpZGVyKFwiaGVpZ2h0XCIsIGUpOyBsb2FkKCkgfSk7XG4gIH1cblxuICBjb25zdCBpbnB1dFBpeGVsWCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibmJQaXhlbFhcIik7XG4gIGlmKGlucHV0UGl4ZWxYKSB7XG4gICAgaW5wdXRQaXhlbFguYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCAoZSkgPT4geyBjaGFuZ2VQaXhlbFNsaWRlcihcInhcIiwgZSk7IGxvYWQoKSB9KTtcbiAgfVxuICBjb25zdCBpbnB1dFBpeGVsWSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibmJQaXhlbFlcIik7XG4gIGlmKGlucHV0UGl4ZWxZKSB7XG4gICAgaW5wdXRQaXhlbFkuYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCAoZSkgPT4geyBjaGFuZ2VQaXhlbFNsaWRlcihcInlcIiwgZSk7IGxvYWQoKSB9KTtcbiAgfVxuXG4gIGNvbnN0IHJlcGV0aXRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJlcGV0aXRpb25cIik7XG4gIGlmKHJlcGV0aXRpb24pIHtcbiAgICByZXBldGl0aW9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgKGUpID0+IHsgY2hhbmdlUmVwZXRpdGlvbihlKTsgbG9hZCgpIH0pO1xuICB9XG5cbiAgLy9jb25uZWN0IGVhY2ggY29sb3IgaW5wdXRcbiAgQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiaW5wdXRbdHlwZT1jb2xvcl1cIikpLmZvckVhY2goIChpdGVtOiBIVE1MSW5wdXRFbGVtZW50KSA9PiB7XG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIGZlZWRDb2xvcnMpO1xuICB9KVxuICAvL3RoZW4gY29sb3JzIGNoZWNrYm94ZXMgY2hlY2tib3hcbiAgQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiaW5wdXRbdHlwZT1jaGVja2JveF1cIikpLmZvckVhY2goIChpdGVtOiBIVE1MSW5wdXRFbGVtZW50KSA9PiB7XG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIGZlZWRDb2xvcnMpO1xuICB9KVxuXG59O1xuXG4iLCJpbXBvcnQgeyBjb2xvckludGVyZmFjZSB9IGZyb20gXCIuL2F2YXRhclwiO1xuXG5leHBvcnQgZnVuY3Rpb24gaGV4VG9SZ2IoaGV4OiBzdHJpbmcpIDogY29sb3JJbnRlcmZhY2Uge1xuICB2YXIgcmVzdWx0ID0gL14jPyhbYS1mXFxkXXsyfSkoW2EtZlxcZF17Mn0pKFthLWZcXGRdezJ9KSQvaS5leGVjKGhleCk7XG4gIHJldHVybiByZXN1bHQgPyB7XG4gICAgcjogcGFyc2VJbnQocmVzdWx0WzFdLCAxNiksXG4gICAgZzogcGFyc2VJbnQocmVzdWx0WzJdLCAxNiksXG4gICAgYjogcGFyc2VJbnQocmVzdWx0WzNdLCAxNilcbiAgfSA6IG51bGw7XG59Il0sInNvdXJjZVJvb3QiOiIifQ==