(()=>{"use strict";function e(e){return void 0===e&&(e="canvas"),document.getElementById(e)}function t(e){return e[Math.floor(Math.random()*e.length)]}function n(e,t,n){t.fillStyle="rgb("+n.r+", "+n.g+", "+n.b+")",t.fillRect(e.x,e.y,e.widthPixel,e.heightPixel)}function o(e,n){for(var o=[],i=0;i<Math.floor(e/2);i++)o.push(t(n));return o.slice(0).reverse().forEach((function(e){return o.push(e)})),e%2!=0&&o.splice(Math.floor(e/2)+1,0,t(n)),o}function i(){var t=e();if(t.getContext){var i=h||8,r=u||8,a=Math.floor(t.width/i),c=t.width%i,l=Math.floor(t.height/r),d=t.height%r,f=t.getContext("2d");f.clearRect(0,0,t.width,t.height),function(e,t,i,r,a){for(var c=e.x,l=e.y,d=e.widthPixel,h=e.heightPixel,u=0;u<r;u+=1)for(var g=o(i,a),f=0;f<g.length;f+=1)n({x:c+f*d,y:l+u*h,widthPixel:d,heightPixel:h},t,g[f])}({x:c/2,y:d/2,widthPixel:a,heightPixel:l},f,i,r,g)}}function r(t,n){var o,i,r,a=n.target.value;"width"===t?(d=a,document.getElementById("widthCanvasValue").textContent=a.toString()):document.getElementById("heightCanvasValue").textContent=a.toString(),o=d,i=a,(r=e()).width=o,r.height=i}function a(e,t){var n=t.target.value;"x"===e?(h=n,document.getElementById("nbPixelXValue").textContent=n.toString()):(u=n,document.getElementById("nbPixelYValue").textContent=n.toString())}function c(){var e=[];Array.from(document.querySelectorAll("input[type=color]")).forEach((function(t,n){var o,i;document.getElementById("color-"+(n+1)).checked&&e.push((o=t.value,(i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(o))?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null))})),g=e.slice(),console.log(g)}function l(){var t=e();if(t){var n=t.toDataURL("image/png").replace("image/png","image/octet-stream");window.location.href=n}else alert("canvas not detected")}var d=0,h=0,u=0,g=[];window.onload=function(){c(),i();var e=document.getElementById("reset-button");e&&e.addEventListener("click",i);var t=document.getElementById("save-button");t&&t.addEventListener("click",l);var n=document.getElementById("widthCanvas");n&&n.addEventListener("change",(function(e){r("width",e),i()}));var o=document.getElementById("heightCanvas");o&&o.addEventListener("change",(function(e){r("height",e),i()}));var d=document.getElementById("nbPixelX");d&&d.addEventListener("change",(function(e){a("x",e),i()}));var h=document.getElementById("nbPixelY");h&&h.addEventListener("change",(function(e){a("y",e),i()})),Array.from(document.querySelectorAll("input[type=color]")).forEach((function(e){e.addEventListener("change",c)})),Array.from(document.querySelectorAll("input[type=checkbox]")).forEach((function(e){e.addEventListener("change",c)}))}})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hdmF0YXItZ2VuZXJhdG9yLy4vc3JjL2NhbnZhcy50cyIsIndlYnBhY2s6Ly9hdmF0YXItZ2VuZXJhdG9yLy4vc3JjL2F2YXRhci50cyIsIndlYnBhY2s6Ly9hdmF0YXItZ2VuZXJhdG9yLy4vc3JjL2luZGV4LnRzIiwid2VicGFjazovL2F2YXRhci1nZW5lcmF0b3IvLi9zcmMvdG9vbHMudHMiXSwibmFtZXMiOlsiZ2V0Q2FudmFzIiwiY2FudmFzSWQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwicmFuZG9tSW5BcnJheUNvbG9yIiwiY29sb3JzIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwibGVuZ3RoIiwiY3JlYXRlU3F1YXJlIiwiYm9yZGVyIiwiY29udGV4dCIsImNvbG9yIiwiZmlsbFN0eWxlIiwiciIsImciLCJiIiwiZmlsbFJlY3QiLCJ4IiwieSIsIndpZHRoUGl4ZWwiLCJoZWlnaHRQaXhlbCIsImdlbmVyYXRlUm93Q29sb3JzIiwibmJQaXhlbFdpZHRoIiwiY29sb3JzUGFsZXR0ZSIsImJpdHNDb2xvciIsImkiLCJwdXNoIiwic2xpY2UiLCJyZXZlcnNlIiwiZm9yRWFjaCIsImJpdCIsInNwbGljZSIsImxvYWQiLCJjYW52YXMiLCJnZXRDb250ZXh0IiwibmJQaXhlbFgiLCJuYlBpeGVsSGVpZ2h0IiwibmJQaXhlbFkiLCJ3aWR0aCIsIm9mZnNldFdpZHRoIiwiaGVpZ2h0Iiwib2Zmc2V0SGVpZ2h0IiwiY2xlYXJSZWN0IiwieE9mZnNldCIsInlPZmZzZXQiLCJjcmVhdGVJbnZhZGVyIiwiY2hhbmdlQ2FudmFzU2xpZGVyIiwic2l6ZSIsImUiLCJuZXdWYWx1ZSIsInRhcmdldCIsInZhbHVlIiwid2lkdGhDYW52YXMiLCJ0ZXh0Q29udGVudCIsInRvU3RyaW5nIiwiY2hhbmdlUGl4ZWxTbGlkZXIiLCJmZWVkQ29sb3JzIiwibmV3Q29sb3JzIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIml0ZW0iLCJpbmRleCIsImhleCIsInJlc3VsdCIsImNoZWNrZWQiLCJleGVjIiwicGFyc2VJbnQiLCJjb25zb2xlIiwibG9nIiwic2F2ZUltYWdlIiwiaW1hZ2UiLCJ0b0RhdGFVUkwiLCJyZXBsYWNlIiwid2luZG93IiwibG9jYXRpb24iLCJocmVmIiwiYWxlcnQiLCJvbmxvYWQiLCJidXR0b24iLCJhZGRFdmVudExpc3RlbmVyIiwic2F2ZUJ1dHRvbiIsImlucHV0V2lkdGgiLCJpbnB1dEhlaWdodCIsImlucHV0UGl4ZWxYIiwiaW5wdXRQaXhlbFkiXSwibWFwcGluZ3MiOiJtQkFDTyxTQUFTQSxFQUFVQyxHQUN4QixZQUR3QixJQUFBQSxNQUFBLFVBQ2pCQyxTQUFTQyxlQUFlRixHQ2tCakMsU0FBU0csRUFBbUJDLEdBQzFCLE9BQU9BLEVBQU9DLEtBQUtDLE1BQU1ELEtBQUtFLFNBQVdILEVBQU9JLFNBSWxELFNBQVNDLEVBQWFDLEVBQXlCQyxFQUFtQ0MsR0FDaEZELEVBQVFFLFVBQVksT0FBT0QsRUFBTUUsRUFBQyxLQUFLRixFQUFNRyxFQUFDLEtBQUtILEVBQU1JLEVBQUMsSUFDMURMLEVBQVFNLFNBQVNQLEVBQU9RLEVBQUdSLEVBQU9TLEVBQUdULEVBQU9VLFdBQVlWLEVBQU9XLGFBSWpFLFNBQVNDLEVBQWtCQyxFQUFzQkMsR0FFL0MsSUFEQSxJQUFJQyxFQUErQixHQUMzQkMsRUFBSSxFQUFHQSxFQUFJckIsS0FBS0MsTUFBTWlCLEVBQWEsR0FBSUcsSUFDN0NELEVBQVVFLEtBQUt4QixFQUFtQnFCLElBVXBDLE9BUEFDLEVBQVVHLE1BQU0sR0FBR0MsVUFBVUMsU0FBUSxTQUFDQyxHQUFRLE9BQUFOLEVBQVVFLEtBQUtJLE1BRzFEUixFQUFlLEdBQU0sR0FDdEJFLEVBQVVPLE9BQU8zQixLQUFLQyxNQUFNaUIsRUFBYSxHQUFLLEVBQUcsRUFBR3BCLEVBQW1CcUIsSUFHbEVDLEVDeENULFNBQVNRLElBQ1IsSUFBTUMsRUFBU25DLElBQ2QsR0FBSW1DLEVBQU9DLFdBQVksQ0FDckIsSUFBTVos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LGVBQ3ZDZ0YsR0FDREEsRUFBV0QsaUJBQWlCLFFBQVNWLEdBR3hDLElBQU1ZLEVBQWFsRixTQUFTQyxlQUFlLGVBQ3hDaUYsR0FDREEsRUFBV0YsaUJBQWlCLFVBQVUsU0FBQ2hDLEdBQVFGLEVBQW1CLFFBQVNFLEdBQUloQixPQUVqRixJQUFNbUQsRUFBY25GLFNBQVNDLGVBQWUsZ0JBQ3pDa0YsR0FDREEsRUFBWUgsaUJBQWlCLFVBQVUsU0FBQ2hDLEdBQVFGLEVBQW1CLFNBQVVFLEdBQUloQixPQUduRixJQUFNb0QsRUFBY3BGLFNBQVNDLGVBQWUsWUFDekNtRixHQUNEQSxFQUFZSixpQkFBaUIsVUFBVSxTQUFDaEMsR0FBUU8sRUFBa0IsSUFBS1AsR0FBSWhCLE9BRTdFLElBQU1xRCxFQUFjckYsU0FBU0MsZUFBZSxZQUN6Q29GLEdBQ0RBLEVBQVlMLGlCQUFpQixVQUFVLFNBQUNoQyxHQUFRTyxFQUFrQixJQUFLUCxHQUFJaEIsT0FJN0UwQixNQUFNQyxLQUFLM0QsU0FBUzRELGlCQUFpQixzQkFBc0IvQixTQUFTLFNBQUNnQyxHQUNuRUEsRUFBS21CLGlCQUFpQixTQUFVeEIsTUFHbENFLE1BQU1DLEtBQUszRCxTQUFTNEQsaUJBQWlCLHlCQUF5Qi9CLFNBQVMsU0FBQ2dDLEdBQ3RFQSxFQUFLbUIsaUJBQWlCLFNBQVV4QixRIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuZXhwb3J0IGZ1bmN0aW9uIGdldENhbnZhcyhjYW52YXNJZDogc3RyaW5nID0gJ2NhbnZhcycpIDogSFRNTENhbnZhc0VsZW1lbnQgfCBudWxsIHtcbiAgcmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNhbnZhc0lkKSBhcyBIVE1MQ2FudmFzRWxlbWVudDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNldENhbnZhc1NpemUod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpIDogdm9pZCAge1xuICBjb25zdCBjYW52YXMgPSBnZXRDYW52YXMoKTtcbiAgY2FudmFzLndpZHRoID0gd2lkdGg7XG4gIGNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkcmF3KGNhbGxiYWNrOiAoY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQpID0+IHZvaWQpIDogdm9pZCB7XG4gIGNvbnN0IGNhbnZhcyA9IGdldENhbnZhcygpO1xuICBpZiAoY2FudmFzLmdldENvbnRleHQpIHtcbiAgICBjb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICBjYWxsYmFjayhjdHgpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjaGFuZ2VCYWNrZ3JvdW5kQ2FudmFzKHJhbmRvbSA6IGJvb2xlYW4gPSBmYWxzZSkgOiB2b2lkIHtcbiAgY29uc3QgY2FudmFzID0gZ2V0Q2FudmFzKCk7XG4gIGlmKGNhbnZhcy5nZXRDb250ZXh0KSB7XG4gICAgY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG4gICAgY29uc3QgY29sb3IgPSByYW5kb20gPyBcbiAgICAgIGByZ2JhKFxuICAgICAgICAgJHtNYXRoLnJhbmRvbSgpICogMjU1fSxcbiAgICAgICAgICR7TWF0aC5yYW5kb20oKSAqIDI1NX0sXG4gICAgICAgICAke01hdGgucmFuZG9tKCkgKiAyNTV9LFxuICAgICAgICAgMSlgOlxuICAgICAgJ3JnYmEoMjEyLDI1NSwxNTYsMSknO1xuICAgIGN0eC5maWxsU3R5bGUgPSBjb2xvcjtcbiAgICBjdHguZmlsbFJlY3QoMCwwLHdpbmRvdy5pbm5lcldpZHRoLHdpbmRvdy5pbm5lckhlaWdodCk7XG4gIH1cbn0iLCJpbnRlcmZhY2UgYm9yZGVySW50ZXJmYWNlIHtcbiAgeDogbnVtYmVyO1xuICB5OiBudW1iZXI7XG4gIHdpZHRoUGl4ZWw6IG51bWJlcjtcbiAgaGVpZ2h0UGl4ZWw6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBjb2xvckludGVyZmFjZSB7XG4gIHI6IG51bWJlcjtcbiAgZzogbnVtYmVyO1xuICBiOiBudW1iZXI7XG59XG5cblxuY29uc3QgQkxBQ0sgOiBjb2xvckludGVyZmFjZSA9IHsgcjogMCwgZzowLCBiOjAgfTtcblxuZnVuY3Rpb24gcmFuZG9tQ29sb3IoKSA6IGNvbG9ySW50ZXJmYWNlIHtcbiAgcmV0dXJuIHsgcjogTWF0aC5yYW5kb20oKSAqIDI1NSwgZzogTWF0aC5yYW5kb20oKSAqIDI1NSwgYjogTWF0aC5yYW5kb20oKSAqIDI1NSB9O1xufVxuXG5mdW5jdGlvbiByYW5kb21JbkFycmF5Q29sb3IoY29sb3JzOiBjb2xvckludGVyZmFjZVtdKSA6IGNvbG9ySW50ZXJmYWNlIHtcbiAgcmV0dXJuIGNvbG9yc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjb2xvcnMubGVuZ3RoKV07XG59IFxuXG5cbmZ1bmN0aW9uIGNyZWF0ZVNxdWFyZShib3JkZXI6IGJvcmRlckludGVyZmFjZSwgY29udGV4dDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELCBjb2xvcjogY29sb3JJbnRlcmZhY2UpIDogdm9pZCB7XG4gIGNvbnRleHQuZmlsbFN0eWxlID0gYHJnYigke2NvbG9yLnJ9LCAke2NvbG9yLmd9LCAke2NvbG9yLmJ9KWA7XG4gIGNvbnRleHQuZmlsbFJlY3QoYm9yZGVyLngsIGJvcmRlci55LCBib3JkZXIud2lkdGhQaXhlbCwgYm9yZGVyLmhlaWdodFBpeGVsKTtcbn1cblxuXG5mdW5jdGlvbiBnZW5lcmF0ZVJvd0NvbG9ycyhuYlBpeGVsV2lkdGg6IG51bWJlciwgY29sb3JzUGFsZXR0ZTogY29sb3JJbnRlcmZhY2VbXSkgOiBjb2xvckludGVyZmFjZVtdIHtcbiAgbGV0IGJpdHNDb2xvciA6IGNvbG9ySW50ZXJmYWNlW10gPSBbXTtcbiAgZm9yKGxldCBpID0gMDsgaSA8IE1hdGguZmxvb3IobmJQaXhlbFdpZHRoLzIpOyBpKyspIHtcbiAgICBiaXRzQ29sb3IucHVzaChyYW5kb21JbkFycmF5Q29sb3IoY29sb3JzUGFsZXR0ZSkpO1xuICB9XG5cbiAgYml0c0NvbG9yLnNsaWNlKDApLnJldmVyc2UoKS5mb3JFYWNoKChiaXQpID0+IGJpdHNDb2xvci5wdXNoKGJpdCkpO1xuXG4gIC8vIGFkZCBvbmUgbW9yZSBiaXRzIGZvciBvZGRzIHdpZHRoXG4gIGlmKG5iUGl4ZWxXaWR0aCAlIDIgIT09IDApIHtcbiAgICBiaXRzQ29sb3Iuc3BsaWNlKE1hdGguZmxvb3IobmJQaXhlbFdpZHRoLzIpICsgMSwgMCwgcmFuZG9tSW5BcnJheUNvbG9yKGNvbG9yc1BhbGV0dGUpKTtcbiAgfVxuXG4gIHJldHVybiBiaXRzQ29sb3I7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVJbnZhZGVyKGJvcmRlciA6IGJvcmRlckludGVyZmFjZSwgY29udGV4dDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELCBuYlBpeGVsV2lkdGg6IG51bWJlciwgbmJQaXhlbEhlaWdodDogbnVtYmVyLCBjb2xvcnNQYWxldHRlOiBjb2xvckludGVyZmFjZVtdKSA6IHZvaWQge1xuICBjb25zdCB7IHg6IHhPZmZzZXQgLCB5OiB5T2Zmc2V0ICwgd2lkdGhQaXhlbCwgaGVpZ2h0UGl4ZWwgfSA9IGJvcmRlcjtcbiAgZm9yKGxldCB5IDogbnVtYmVyID0gMDsgeSA8IG5iUGl4ZWxIZWlnaHQ7IHkgKz0gMSkge1xuICAgIGNvbnN0IGJpdHNDb2xvciA9IGdlbmVyYXRlUm93Q29sb3JzKG5iUGl4ZWxXaWR0aCwgY29sb3JzUGFsZXR0ZSk7XG4gICAgZm9yKGxldCB4OiBudW1iZXIgPSAwOyB4IDwgYml0c0NvbG9yLmxlbmd0aDsgeCArPSAxKSB7XG4gICAgICBjcmVhdGVTcXVhcmUoXG4gICAgICAgIHsgeDogeE9mZnNldCArICh4ICogd2lkdGhQaXhlbCksXG4gICAgICAgICAgeTogeU9mZnNldCArICh5ICogaGVpZ2h0UGl4ZWwpLFxuICAgICAgICAgIHdpZHRoUGl4ZWwsXG4gICAgICAgICAgaGVpZ2h0UGl4ZWxcbiAgICAgICAgIH0sXG4gICAgICAgICBjb250ZXh0LFxuICAgICAgICAgYml0c0NvbG9yW3hdXG4gICAgICApO1xuICAgIH1cbiAgfVxufSIsImltcG9ydCB7IHNldENhbnZhc1NpemUsIGNoYW5nZUJhY2tncm91bmRDYW52YXMsIGdldENhbnZhcywgZHJhdyB9IGZyb20gXCIuL2NhbnZhc1wiO1xuaW1wb3J0IHsgY3JlYXRlSW52YWRlciwgY29sb3JJbnRlcmZhY2UgfSBmcm9tIFwiLi9hdmF0YXJcIjtcbmltcG9ydCB7IGhleFRvUmdiIH0gZnJvbSBcIi4vdG9vbHNcIjtcblxuZnVuY3Rpb24gbG9hZCgpIHtcbiBjb25zdCBjYW52YXMgPSBnZXRDYW52YXMoKTtcbiAgaWYgKGNhbnZhcy5nZXRDb250ZXh0KSB7XG4gICAgY29uc3QgbmJQaXhlbFdpZHRoID0gbmJQaXhlbFggfHwgODtcbiAgICBjb25zdCBuYlBpeGVsSGVpZ2h0ID0gbmJQaXhlbFkgfHwgODtcbiAgICBjb25zdCB3aWR0aFBpeGVsID0gTWF0aC5mbG9vcihjYW52YXMud2lkdGggLyBuYlBpeGVsV2lkdGgpO1xuICAgIGNvbnN0IG9mZnNldFdpZHRoID0gKGNhbnZhcy53aWR0aCAlIG5iUGl4ZWxXaWR0aCk7XG4gICAgXG4gICAgY29uc3QgaGVpZ2h0UGl4ZWwgPSBNYXRoLmZsb29yKGNhbnZhcy5oZWlnaHQgLyBuYlBpeGVsSGVpZ2h0KTtcbiAgICBjb25zdCBvZmZzZXRIZWlnaHQgPSAoY2FudmFzLmhlaWdodCAlIG5iUGl4ZWxIZWlnaHQpO1xuXG4gICAgY29uc3QgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgIC8vIHJlZnJlc2hcbiAgICBjb250ZXh0LmNsZWFyUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xuICAgIFxuICAgIGNyZWF0ZUludmFkZXIoe3g6IG9mZnNldFdpZHRoIC8yICwgeTogb2Zmc2V0SGVpZ2h0IC8gMiwgd2lkdGhQaXhlbCwgaGVpZ2h0UGl4ZWwgfSwgY29udGV4dCwgbmJQaXhlbFdpZHRoLCBuYlBpeGVsSGVpZ2h0LCBjb2xvcnMpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNoYW5nZUNhbnZhc1NsaWRlcihzaXplOiBcIndpZHRoXCJ8IFwiaGVpZ2h0XCIsIGU6IEV2ZW50KSA6IHZvaWQge1xuICBjb25zdCBuZXdWYWx1ZSA6IG51bWJlciA9IChlIGFzIGFueSkudGFyZ2V0LnZhbHVlO1xuICBpZihzaXplID09PSBcIndpZHRoXCIpIHtcbiAgICB3aWR0aENhbnZhcyA9IG5ld1ZhbHVlO1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwid2lkdGhDYW52YXNWYWx1ZVwiKS50ZXh0Q29udGVudCA9IG5ld1ZhbHVlLnRvU3RyaW5nKCk7XG4gIH0gZWxzZSB7XG4gICAgaGVpZ2h0Q2FudmFzID0gbmV3VmFsdWU7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJoZWlnaHRDYW52YXNWYWx1ZVwiKS50ZXh0Q29udGVudCA9IG5ld1ZhbHVlLnRvU3RyaW5nKCk7XG4gIH1cbiAgc2V0Q2FudmFzU2l6ZSh3aWR0aENhbnZhcywgbmV3VmFsdWUpO1xufVxuXG5mdW5jdGlvbiBjaGFuZ2VQaXhlbFNsaWRlcihzaXplOiBcInhcInwgXCJ5XCIsIGU6IEV2ZW50KSA6IHZvaWQge1xuICBjb25zdCBuZXdWYWx1ZSA6IG51bWJlciA9IChlIGFzIGFueSkudGFyZ2V0LnZhbHVlO1xuICBpZihzaXplID09PSBcInhcIikge1xuICAgIG5iUGl4ZWxYID0gbmV3VmFsdWU7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuYlBpeGVsWFZhbHVlXCIpLnRleHRDb250ZW50ID0gbmV3VmFsdWUudG9TdHJpbmcoKTtcbiAgfSBlbHNlIHtcbiAgICBuYlBpeGVsWSA9IG5ld1ZhbHVlO1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibmJQaXhlbFlWYWx1ZVwiKS50ZXh0Q29udGVudCA9IG5ld1ZhbHVlLnRvU3RyaW5nKCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gZmVlZENvbG9ycygpIHtcbiAgY29uc3QgbmV3Q29sb3JzIDogY29sb3JJbnRlcmZhY2VbXSA9IFtdO1xuICBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbnB1dFt0eXBlPWNvbG9yXVwiKSkuZm9yRWFjaCgoaXRlbTogSFRNTElucHV0RWxlbWVudCwgaW5kZXg6IG51bWJlcikgPT4ge1xuICAgIGNvbnN0IGNoZWNrYm94ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYGNvbG9yLSR7aW5kZXgrMX1gKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgIGlmKGNoZWNrYm94LmNoZWNrZWQpIHtcbiAgICAgIG5ld0NvbG9ycy5wdXNoKGhleFRvUmdiKGl0ZW0udmFsdWUpKTtcbiAgICB9XG4gIH0pO1xuICBjb2xvcnMgPSBuZXdDb2xvcnMuc2xpY2UoKTtcbiAgY29uc29sZS5sb2coY29sb3JzKTtcbn1cblxuZnVuY3Rpb24gc2F2ZUltYWdlKCkge1xuICBjb25zdCBjYW52YXMgPSBnZXRDYW52YXMoKTtcbiAgaWYoY2FudmFzKSB7XG4gICAgY29uc3QgaW1hZ2UgPSBjYW52YXMudG9EYXRhVVJMKFwiaW1hZ2UvcG5nXCIpLnJlcGxhY2UoXCJpbWFnZS9wbmdcIiwgXCJpbWFnZS9vY3RldC1zdHJlYW1cIik7XG4gICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBpbWFnZTtcbiAgfSBlbHNlIHtcbiAgICBhbGVydChcImNhbnZhcyBub3QgZGV0ZWN0ZWRcIik7XG4gIH1cbn1cblxuLy8gR0xPQkFMUyBWQVJJQUJMRVNcbmxldCB3aWR0aENhbnZhcyA9IDA7XG5sZXQgaGVpZ2h0Q2FudmFzID0gMDtcbmxldCBuYlBpeGVsWCA9IDA7XG5sZXQgbmJQaXhlbFkgPSAwO1xubGV0IGNvbG9ycyA6Y29sb3JJbnRlcmZhY2VbXSA9IFtdO1xud2luZG93Lm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICBmZWVkQ29sb3JzKCk7XG4gIGxvYWQoKTtcbiAgXG4gIC8vIGNvbm5lY3QgYnV0dG9uICsgaW5wdXRzXG4gIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVzZXQtYnV0dG9uXCIpO1xuICAgaWYoYnV0dG9uKSB7XG4gICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgbG9hZCk7XG4gIH1cblxuICBjb25zdCBzYXZlQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzYXZlLWJ1dHRvblwiKTtcbiAgIGlmKHNhdmVCdXR0b24pIHtcbiAgICAgc2F2ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgc2F2ZUltYWdlKTtcbiAgfVxuXG4gIGNvbnN0IGlucHV0V2lkdGggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIndpZHRoQ2FudmFzXCIpO1xuICBpZihpbnB1dFdpZHRoKSB7XG4gICAgaW5wdXRXaWR0aC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIChlKSA9PiB7IGNoYW5nZUNhbnZhc1NsaWRlcihcIndpZHRoXCIsIGUpOyBsb2FkKCkgfSk7XG4gIH1cbiAgY29uc3QgaW5wdXRIZWlnaHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImhlaWdodENhbnZhc1wiKTtcbiAgaWYoaW5wdXRIZWlnaHQpIHtcbiAgICBpbnB1dEhlaWdodC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIChlKSA9PiB7IGNoYW5nZUNhbnZhc1NsaWRlcihcImhlaWdodFwiLCBlKTsgbG9hZCgpIH0pO1xuICB9XG5cbiAgY29uc3QgaW5wdXRQaXhlbFggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5iUGl4ZWxYXCIpO1xuICBpZihpbnB1dFBpeGVsWCkge1xuICAgIGlucHV0UGl4ZWxYLmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgKGUpID0+IHsgY2hhbmdlUGl4ZWxTbGlkZXIoXCJ4XCIsIGUpOyBsb2FkKCkgfSk7XG4gIH1cbiAgY29uc3QgaW5wdXRQaXhlbFkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5iUGl4ZWxZXCIpO1xuICBpZihpbnB1dFBpeGVsWSkge1xuICAgIGlucHV0UGl4ZWxZLmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgKGUpID0+IHsgY2hhbmdlUGl4ZWxTbGlkZXIoXCJ5XCIsIGUpOyBsb2FkKCkgfSk7XG4gIH1cblxuICAvL2Nvbm5lY3QgZWFjaCBjb2xvciBpbnB1dFxuICBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbnB1dFt0eXBlPWNvbG9yXVwiKSkuZm9yRWFjaCggKGl0ZW06IEhUTUxJbnB1dEVsZW1lbnQpID0+IHtcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgZmVlZENvbG9ycyk7XG4gIH0pXG4gIC8vdGhlbiBjb2xvcnMgY2hlY2tib3hlcyBjaGVja2JveFxuICBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbnB1dFt0eXBlPWNoZWNrYm94XVwiKSkuZm9yRWFjaCggKGl0ZW06IEhUTUxJbnB1dEVsZW1lbnQpID0+IHtcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgZmVlZENvbG9ycyk7XG4gIH0pXG5cbn07XG5cbiIsImltcG9ydCB7IGNvbG9ySW50ZXJmYWNlIH0gZnJvbSBcIi4vYXZhdGFyXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBoZXhUb1JnYihoZXg6IHN0cmluZykgOiBjb2xvckludGVyZmFjZSB7XG4gIHZhciByZXN1bHQgPSAvXiM/KFthLWZcXGRdezJ9KShbYS1mXFxkXXsyfSkoW2EtZlxcZF17Mn0pJC9pLmV4ZWMoaGV4KTtcbiAgcmV0dXJuIHJlc3VsdCA/IHtcbiAgICByOiBwYXJzZUludChyZXN1bHRbMV0sIDE2KSxcbiAgICBnOiBwYXJzZUludChyZXN1bHRbMl0sIDE2KSxcbiAgICBiOiBwYXJzZUludChyZXN1bHRbM10sIDE2KVxuICB9IDogbnVsbDtcbn0iXSwic291cmNlUm9vdCI6IiJ9